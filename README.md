# circuit-breaker
简单断路器

**问题:**  实现一个简单的断路器，断线器的功能：当某一段代码发生错误率达到阈值的情况下，进入打开状态，自动执行 fallback 逻辑，一定的时间后自动重新合上执行默认逻辑

思路: 包括断路器  断路策略 断路回调等组件; 包括代理接口的功能; 策略模式 自由搭配不同的断路策略 , 健康状态上报 等;


**0.1 版本**

1.构建一个断路器circuitBreaker,给定断路策略strategy，代理代码块(方法级别)，断路后的处理回调策略handler; 

2.抽象方法或代码块代理 Task;

2.抽象断路器类 为断路器 简单执行流程   (if isBreaker ->callBack   else  executing )    ---> record metrics !

3.断路策略 分为很多种; 如  控制执行被代理代码块的线程数量  平均响应时间  最近执行失败率等等; （0.1版本只实现了 **默认的简单策略**:既最近N次请求 失败M次统计失败率 大于阈值 打开走回调 delay时间后直接关闭 只有开/关两种状态 暂不考虑半开状态)

**0.1 版本  TODO:**
1. 自定义断路器注解 以AOP 切面的方式代理方法; 

2. 抽象CircuitBreakerFactory 提供更通用的使用形式;

3. 健康状态上报 同步改异步 , 针对task不同状态，封装 不同事件 ;

4. 令牌桶或滑动窗口实现 更多通用的断路策略;

5. 结合spring  基于配置文件动态配置 等等;

//....
